### `compute_weight_importance(model, X, skip_last=True)`

Computes the importance of weights for each dense (TF/Keras) or linear (PyTorch) layer in the model.

-   **Parameters**:
    -   `model` (tf.keras.Model | torch.nn.Module): The model to be analyzed.
    -   `X` (np.ndarray | torch.Tensor): The input data used to calculate average activations.
    -   `skip_last` (bool): If `True`, ignores the last linear/dense layer, which is often useful as its importance is harder to interpret (no post-neuron activation).

-   **Returns**:
    -   `List[Tuple[np.ndarray, np.ndarray, str]]`: A list of tuples. Each tuple contains:
        1.  An importance matrix (shape `(input_dim, output_dim)`).
        2.  A weight matrix (shape `(output_dim, input_dim)`).
        3.  The layer's name.

---

### `generate_report(importance, weights)`

Generates a dictionary of analysis metrics from the importance and weight matrices of a single layer.

-   **Parameters**:
    -   `importance` (np.ndarray): The importance matrix generated by `compute_weight_importance`.
    -   `weights` (np.ndarray): The corresponding weight matrix.

-   **Returns**:
    -   `Tuple[Dict[str, float], np.ndarray]`: A tuple containing:
        1.  A report dictionary with keys: `total_weights`, `nodes`, `entropy`, `effective_weights`, `top_90_percent_contrib`, `low_contrib_percentage`.
        2.  A 1D array of the normalized importance of each weight.

---

### `print_report(report)`

Prints a formatted report to the console from the dictionary generated by `generate_report`.

-   **Parameters**:
    -   `report` (Dict[str, float]): The report dictionary.

---

### `plot_importance_histogram(normalized_importance, entropy_val=None)`

Displays a histogram of the normalized weight importance distribution.

-   **Parameters**:
    -   `normalized_importance` (np.ndarray): The 1D array of normalized importance returned by `generate_report`.
    -   `entropy_val` (float, optional): If provided, displays the entropy value in the chart's title.

---

### `estimate_flops(model, nb_epochs, dataset)`

Estimates the FLOPs for training and inference.

-   **Parameters**:
    -   `model` (tf.keras.Model | torch.nn.Module): The model to be evaluated.
    -   `nb_epochs` (int): The number of training epochs to simulate for the calculation.
    -   `dataset` (np.ndarray): The dataset (only the number of samples and shape are used).

-   **Returns**:
    -   `Tuple[int, int]`: A tuple containing:
        1.  Total estimated FLOPs for training.
        2.  Total estimated FLOPs for inference over the entire dataset.

---

### `print_flops_report(model, nb_epochs, dataset)`

Calculates and prints a formatted FLOPs report to the console.

-   **Parameters**:
    -   Same as `estimate_flops`.

---

### `show(model, X)`

Generates and displays a visualization of the neural network architecture, where weight importance is represented by the thickness and color of the connections.

-   **Parameters**:
    -   `model` (tf.keras.Model | torch.nn.Module): The model to visualize.
    -   `X` (np.ndarray): The input data.